# first we declare our upstream server, which is our Gunicorn application
upstream web {
    # docker will automatically resolve this to the correct address
    # because we use the same name as the service: "knit_server"
    ip_hash;
    server knit_server:8000;
}

# now we declare our main server
server {

    location /static/ {    
        autoindex on;    
        alias /app/; 
    }
    
    location /assets/ {
        alias /app/;
    }
    location / {
        proxy_pass http://web/;
    }
    listen 8000;
    server_name localhost;
}