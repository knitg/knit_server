# first we declare our upstream server, which is our Gunicorn application
upstream web {
    # docker will automatically resolve this to the correct address
    # because we use the same name as the service: "knit_server"
    ip_hash;
    server knit_server:8000;
}

# now we declare our main server
server {

    location /static/ {    
        autoindex on;    
        alias /static; 
    }
    
    location /media/ {
        alias /media;
    }
    location /api/ {
        proxy_pass http://34.87.48.33:8000/;
    }
    listen 8000;
    server_name localhost;
}